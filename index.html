<html>
  <head>
    <title>Public Client Flow</title>
    <script src='//code.jquery.com/jquery-1.11.2.min.js'></script>
    <script src="https://sdk-cdn.mypurecloud.com/javascript/85.0.0/purecloud-platform-client-v2.min.js"></script>
    <script>
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\#&]" + name + "=([^&#]*)"),
          results = regex.exec(location.hash);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    if(window.location.hash) {
        console.log(location.hash);
        var token = getParameterByName('access_token');

        $.ajax({
            url: "https://api.mypurecloud.de/api/v2/users/me",
            type: "GET",
            beforeSend: function(xhr){xhr.setRequestHeader('Authorization', 'bearer ' + token);},
            success: function(data) {
                console.log(data);
                document.getElementById('Prenom').innerHTML = 'Prenom : '+data['name'].split(' ')[0];
                document.getElementById('Nom').innerHTML = 'Nom : '+data['name'].split(' ')[1];
                document.getElementById('department').innerHTML = 'department : '+data['department'];
                document.getElementById('Qualification').innerHTML = 'Qualification : '+data['title'];

            }
        });

        location.hash=''

    } else {
        var queryStringData = {
            response_type : "token",
            client_id : "4d7b3393-c5ed-45de-9597-9a433cf174a5",
            redirect_uri : "https://helplineudj.github.io/"
        }

        window.location.replace("https://login.mypurecloud.de/oauth/authorize?" + jQuery.param(queryStringData));
    }
    </script>
</head>
<body>
    <div class="container">
      <div class="row">
        <div class="col">
          <img id="CA" src="Image7.png" class="img-responsive" style="width:80%;" alt="CA img">
        </div>
        <div class="col text-right">
          <img id="helpline" src="helpline.png" class="img-responsive" style="width:60%;" alt="Helpline img">
        </div>
      </div><br>
      <div class="row">
        <div class="col">
          <ul class="list-group">
            <li class="list-group-item" id="Nom">Nom : </li>
            <li class="list-group-item" id="Prenom">Prenom : </li>
            <li class="list-group-item" id="department">Departement : </li>
            <li class="list-group-item" id="Qualification">Qualification : </li>
          </ul>
        </div>
      </div><br>
</body>
</html>